#!/bin/bash

# --- Configuration ---
GRAMMAR_FILE="Mcdalang.g4"
TARGET_DIR="../generated"
PACKAGE_DECL="package n7.mcdalang.models.antlr.generated;"

# --- √âtape 1 : G√©n√©ration avec ANTLR ---
echo "üîÑ G√©n√©ration avec ANTLR..."
antlr4 "$GRAMMAR_FILE" -o "$TARGET_DIR"

# --- √âtape 2 : Ajout du package ---
echo "üì¶ Ajout du package dans les fichiers g√©n√©r√©s..."
for file in "$TARGET_DIR"/*.java; do
    if ! grep -q "$PACKAGE_DECL" "$file"; then
        # Utilise sed pour ins√©rer le package au tout d√©but du fichier
        sed -i "1i$PACKAGE_DECL\n" "$file"
    fi
done

echo "‚úÖ Termin√©."
